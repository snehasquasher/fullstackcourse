# ðŸš€ Spur GitHub Actions Workflow
name: Trigger Spur Webhook on Push ðŸ””

on:
  workflow_run:
    workflows: ["Set Vercel Preview URL"]
    types:
      - completed
      
jobs:  
    trigger_webhook: 
        runs-on: ubuntu-latest  

        steps:
          - name: Download Preview URL Artifact
            uses: actions/download-artifact@v3
            with:
              name: preview-url

          - name: Read and Use Preview URL
            run: |
              preview_url=$(cat preview-url.txt)
              echo "The preview URL is $preview_url"

          - name: ðŸ“¡ Curl Request to Trigger TestSuites on Spur
            run: |
                  curl -X POST \
                  -H "Content-Type: application/json" \
                  -H "SPUR_GITHUB_KEY: U2FsdGVkX18M5+rGuEBHwgvlwpw9llDiChjGbhgwOj3e3IcP+ABwsf/UdWzHtGWV" \
                  -H "repo: snehasquasher/fullstackcourse" \
                  -H "sha: ${{ github.sha }}"  \
                  -H "override_url:$preview_url" \
                  "https://spurserverwebappmulticore.azurewebsites.net/api/integrations/github/webhook"

# ðŸŽˆ Happy testing with Spur! ðŸŽˆ
#23c620ccbf6bc2063bda21db900f55e33d0977ad
